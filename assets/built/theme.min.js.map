{"version":3,"sources":["dark-mode-toggle.js","dropdown-navigation.js","pagination.js","copy-link.js","table-of-contents.js","lightbox.js"],"names":["storedTheme","darkModeToggle","document","getElementById","localStorage","getItem","window","matchMedia","matches","documentElement","setAttribute","setTimeout","onclick","targetTheme","getAttribute","setItem","menuIndentRegex","processMenuItems","div1","p1","menuItems","querySelectorAll","let","submenu","i","length","menuName","div","match","lastElementChild","innerText","replace","trim","classList","add","anchor","createElement","appendChild","createTextNode","sup","p2","ol","replaceChildren","remove","querySelector","toggleMenuButton","closeMenuButton","nav","submenus","toggleMenu","toggle","toggleSubmenu","event","selectedItem","target","parentNode","contains","preventDefault","addEventListener","forEach","key","submenuToggle","submenuHeader","openSubmenu","closest","isInfinite","currentArticleList","buffer","ticking","loading","lastScrollY","lastWindowHeight","lastDocumentHeight","buttonElement","nextElement","onPageLoad","fragment","resNextElement","this","status","removeEventListener","onScroll","onResize","nextPageArticleList","response","createDocumentFragment","item","clonedItem","importNode","href","scrollHeight","imagesLoaded","getBoundingClientRect","bottom","console","log","requestTick","onUpdate","xhr","XMLHttpRequest","responseType","open","send","requestAnimationFrame","scrollY","innerHeight","passive","copyLinkElement","navigator","clipboard","writeText","location","tooltip","className","textContent","tocbot","init","tocSelector","contentSelector","hasInnerContainers","tocButton","tableOfContents","toggleTableOfContents","e","tocToggleButton","updateProgress","totalHeight","body","clientHeight","windowHeight","progress","toFixed","style","setProperty","PhotoSwipeLightbox","arrow","lightbox","arrowPrevSVG","arrowNextSVG","zoom","gallery","children","bgOpacity","closeOnScroll","Xpadding","top","left","right","imageClickAction","tapAction","pswpModule","import","addFilter","itemData","element","linkEl","w","h","naturalWidth","naturalHeight","src","srcset"],"mappings":"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","file":"theme.min.js","sourcesContent":["\n(function() {\n    var darkModeToggle = document.getElementById(\"dark-mode-toggle\");\n\n    if (darkModeToggle) {\n        var storedTheme = localStorage.getItem('theme') || (window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\");\n        if (storedTheme)\n            document.documentElement.setAttribute('data-theme', storedTheme)\n\n        setTimeout(function() {\n            var targetTheme = storedTheme == \"dark\" ? \"light\" : \"dark\";\n        }, 1000);\n\n        darkModeToggle.onclick = function() {\n            var currentTheme = document.documentElement.getAttribute(\"data-theme\");\n            var targetTheme = \"light\";\n\n            if (currentTheme === \"light\") {\n                targetTheme = \"dark\";\n            }\n\n            document.documentElement.setAttribute('data-theme', targetTheme)\n            localStorage.setItem('theme', targetTheme);\n\n        };\n    }\n})();","/* \n* create the <li> html structure under the <nav> element used in the site-header\n* the items are structured based on markup in the ghost navigation names:\n* names prefixed with - indicate a submenu and -- indicates a submenu item\n* for example\n*\n*  ghost navigation          rendered html\n*  -----------------         ------------------\n*  HOME                      <li class=\"item\">\n*                              <a href=\"http://localhost:2368/\">HOME</a>\n*                            </li>\n*  -HONDA C90                <li class=\"item has-submenu\">\n*                                <a href=\"#\">HONDA C90 ⌄</a>\n*                                <div class=\"submenu\">\n*                                    <div class=\"submenu-header\">\n*                                        <p class=\"submenu-title\">HONDA C90</p>\n*                                        <button class=\"submenu-close icon\">✕</button>\n*                                    </div>\n*                                    <ol class=\"submenu-items\">\n*  --introduction                        <li class=\"submenu-item\">\n*                                            <a href=\"http://localhost:2368/2019/11/16/honda-c90-introduction/\">introduction</a>\n*                                        </li>\n*  --engine                              <li class=\"submenu-item\">\n*                                            <a href=\"http://localhost:2368/tag/engine/\">engine</a>\n*                                        </li>\n*                                    </ol>\n*                                </div>\n*                            </li>\n*/\n\n(function () {\n  const menuIndentRegex = /(^-{1,})(.*)/; // Match the -submenu and --submenu-item navigation entries\n\n  // Function to create submenu structure\n  function createSubMenu(menuName) {\n      const div = document.createElement('div');\n      div.classList.add('submenu');\n\n      const div1 = document.createElement('div');\n      div1.classList.add('submenu-header');\n\n      const p1 = document.createElement('p');\n      p1.classList.add('submenu-title');\n      p1.appendChild(document.createTextNode(menuName));\n      div1.appendChild(p1);\n\n      const p2 = document.createElement('button');\n      p2.classList.add('submenu-close', 'icon');\n      p2.appendChild(document.createTextNode('✕'));\n      div1.appendChild(p2);\n\n      div.appendChild(div1);\n\n      const ol = document.createElement('ol');\n      ol.classList.add('submenu-items');\n\n      div.appendChild(ol);\n\n      return div;\n  }\n\n  // Main function to process menu items\n  function processMenuItems() {\n      const menuItems = document.querySelectorAll('.nav-items .item');\n      let submenu = null;\n\n      for (let i = 0; i < menuItems.length; ++i) {\n          const match = menuItems[i].lastElementChild.innerText.match(menuIndentRegex);\n\n          if (match) {\n              // Remove the submenu & submenu-item indent indicators (- --)\n              menuItems[i].lastElementChild.innerText = menuItems[i].lastElementChild.innerText.replace(menuIndentRegex,\"$2\").trim();\n              const menuName=menuItems[i].lastElementChild.innerText;\n\n              if (match[1].length == 1) { // Submenu (-)\n                  menuItems[i].classList.add('has-submenu');\n\n                  const anchor = document.createElement(\"a\");\n                  anchor.setAttribute(\"href\", \"#\");\n                  anchor.classList.add('tabindex=0');\n                  anchor.appendChild(document.createTextNode(menuName));\n          \n                  const sup = document.createElement('sup');\n                  sup.appendChild(document.createTextNode(' ⌄'));\n                  anchor.appendChild(sup);\n\n                  const div = createSubMenu(menuName);\n                  menuItems[i].replaceChildren(anchor);\n                  menuItems[i].appendChild(div);\n                  submenu = menuItems[i];\n              } else if (submenu) { // Submenu item (--)\n                  menuItems[i].classList.add('submenu-item');\n                  menuItems[i].classList.remove('item');\n                  submenu.querySelector('.submenu-items').appendChild(menuItems[i]);\n              }\n          }\n      }\n\n      document.querySelector('.nav').classList.add('nav-ready');\n  }\n\n  processMenuItems();\n})();\n\n/* \n * toggle nav and submenus\n * .nav.nav-open is set when the nav is opened using the hamburger button \n * .submenu.submenu-open is set when an item with a submenu is opened\n*/\n(function() {\n  const toggleMenuButton = document.querySelector(\".nav-toggle\");\n  const closeMenuButton = document.querySelector(\".nav-close\");\n  const nav = document.querySelector(\".nav\");\n  const submenus = document.querySelectorAll(\".item.has-submenu > *\");\n\n  // Toggle the main nav using the hamburger toggle \n  function toggleMenu() {\n    nav.classList.toggle(\"nav-open\");\n  }\n\n  function toggleSubmenu(event) {\n    const selectedItem = event.target.parentNode;\n\n    if (selectedItem.classList.contains(\"has-submenu\")) {\n      event.preventDefault(); // prevent the default link action from causing the page to jump to top of screen\n\n      selectedItem.querySelector(\".submenu\").classList.toggle(\"submenu-open\");\n      /*\n      if (selectedItem.classList.contains(\"submenu-open\")) {\n        selectedItem.classList.remove(\"submenu-open\");\n      } else {\n        const openSubmenu = nav.querySelector(\".submenu-open\");\n        if (openSubmenu && openSubmenu !== selectedItem) { // another submenu is open \n          openSubmenu.classList.remove(\"submenu-open\");\n        }\n        selectedItem.classList.add(\"submenu-open\");\n      }\n      */\n\n    }\n  }\n\n  // Close any open submenu when clicking outside\n  function closeSubmenuOnClickOutside(event) {\n    const openSubmenu = nav.querySelector(\".submenu-open\");\n    if (openSubmenu) {\n      const submenuToggle = openSubmenu.closest('.has-submenu'); // Find the parent with 'has-submenu'\n      const submenuHeader = openSubmenu.querySelector('.submenu-header'); // Find the submenu header\n\n      if (!openSubmenu.contains(event.target) && \n          !submenuToggle.contains(event.target) ||\n          (submenuHeader && submenuHeader.contains(event.target))) {\n        openSubmenu.classList.remove(\"submenu-open\");\n      }\n    }\n  }\n\n  toggleMenuButton.addEventListener('click', toggleMenu);\n  closeMenuButton.addEventListener('click', toggleMenu);\n \n  submenus.forEach(submenu => {\n    submenu.addEventListener(\"click\", toggleSubmenu);\n    submenu.addEventListener(\"keypress\", function(event) {\n      if (event.key === \"Enter\" || event.key === \" \") {\n        toggleSubmenu(event);\n      }\n    });\n  });\n\n  window.addEventListener('click', closeSubmenuOnClickOutside);\n})();\n","/* pagination */\n(function (isInfinite, callback) {\n    var buttonElement = document.querySelector('.pagination');\n\n    // next link element\n    var nextElement = document.querySelector('link[rel=next]');\n    if (!nextElement && buttonElement) {\n        buttonElement.remove();\n        return;\n    }\n\n    // post list element\n    var currentArticleList = document.querySelector('.paginated');\n    if (!currentArticleList) {\n        return;\n    }\n\n    var buffer = 300;\n\n    var ticking = false;\n    var loading = false;\n\n    var lastScrollY = window.scrollY;\n    var lastWindowHeight = window.innerHeight;\n    var lastDocumentHeight = document.documentElement.scrollHeight;\n\n    function onPageLoad() {\n        if (this.status === 404) {\n            window.removeEventListener('scroll', onScroll);\n            window.removeEventListener('resize', onResize);\n            buttonElement.remove();\n            return;\n        }\n\n        // append next page of article-cards\n        // the next elements are organized as per index.hbs\n        var nextPageArticleList = this.response.querySelectorAll('.article-card');\n        var fragment = document.createDocumentFragment();\n        var elems = [];\n        nextPageArticleList.forEach(function (item) {\n            // document.importNode is important, without it the item's owner\n            // document will be different which can break resizing of\n            // `object-fit: cover` images in Safari\n\n            var clonedItem = document.importNode(item, true);\n\n            if (callback) {\n                clonedItem.style.position = 'absolute';\n                clonedItem.style.visibility = 'hidden';\n                elems.push(clonedItem);\n            }\n\n            fragment.appendChild(clonedItem);\n        });\n\n        currentArticleList.appendChild(fragment);\n\n        if (callback) {\n            callback(elems);\n        }\n\n        // set next link\n        var resNextElement = this.response.querySelector('link[rel=next]');\n        if (resNextElement) {\n            nextElement.href = resNextElement.href;\n        } else {\n            window.removeEventListener('scroll', onScroll);\n            window.removeEventListener('resize', onResize);\n            if (buttonElement) {\n                buttonElement.remove();\n            }\n        }\n\n        // sync status\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        ticking = false;\n        loading = false;\n\n        if (isInfinite) {\n            imagesLoaded(currentArticleList, function () {\n                if (currentArticleList.getBoundingClientRect().bottom <= lastWindowHeight) {\n                    console.log(currentArticleList.getBoundingClientRect().bottom, lastWindowHeight)\n                    requestTick();\n                }\n            });\n        }\n    }\n\n    function onUpdate() {\n        // return if already loading\n        if (loading) {\n            return;\n        }\n\n        // return if not scroll to the bottom\n        if (isInfinite && lastScrollY + lastWindowHeight <= lastDocumentHeight - buffer) {\n            ticking = false;\n            return;\n        }\n\n        loading = true;\n\n        var xhr = new window.XMLHttpRequest();\n        xhr.responseType = 'document';\n\n        xhr.addEventListener('load', onPageLoad);\n\n        xhr.open('GET', nextElement.href);\n        xhr.send(null);\n    }\n\n    function requestTick() {\n        ticking || window.requestAnimationFrame(onUpdate);\n        ticking = true;\n    }\n\n    function onScroll() {\n        lastScrollY = window.scrollY;\n        requestTick();\n    }\n\n    function onResize() {\n        lastWindowHeight = window.innerHeight;\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        requestTick();\n    }\n\n    if (isInfinite) {\n        window.addEventListener('scroll', onScroll, {passive: true});\n        window.addEventListener('resize', onResize);\n        requestTick();\n    } else {\n        buttonElement.addEventListener('click', requestTick);\n    }\n})(false);\n","/* copy link button (copies link and shows a tooltip)  */\n(function() {\n    const copyLinkElement = document.getElementById(\"copy-link\")  ;\n    if (! copyLinkElement)\n        return;\n\n    function copyLink() {\n        navigator.clipboard.writeText(window.location.href);\n\n        const tooltip = document.createElement('div');\n        tooltip.className = 'tooltip';\n        tooltip.textContent = 'Copied!';\n        copyLinkElement.appendChild(tooltip);\n\n        setTimeout(() => { tooltip.remove(); }, 1000);\n    }\n    copyLinkElement.addEventListener(\"click\", copyLink, false);\n})();","/*\n * table of contents initialistation\n*/\n(function () {\n    tocbot.init({\n    tocSelector: '.toc',\n    contentSelector: '.article-content',\n    hasInnerContainers: true\n    })\n})();\n\n\n/* \n * toggle mobile toc when toc icon is clicked\n*/\n(function() {\n    const tocButton = document.querySelector(\"#toc-toggle\");\n    const tableOfContents = document.querySelector(\".table-of-contents\");\n  \n    function toggleTableOfContents(){\n        tableOfContents.classList.toggle(\"toc-open\");\n    }\n    if (!tocButton) {\n      return;\n    }\n\n    window.addEventListener('click', function(e){\n      /* close toc when clicking anywhere on the toc */\n      if (tableOfContents.querySelector(\"toc-open\")) {\n        let isClickInside = tableOfContents.querySelector(\"toc-open\").contains(e.target);\n  \n        if (!isClickInside && tableOfContents.querySelector(\"toc-open\")) {\n          tableOfContents.querySelector(\"toc-open\").classList.remove(\"toc-open\");\n        }\n      }\n      /* close toc when clicking ouside the toc */\n      if (!tableOfContents.contains(e.target) && !tocButton.contains(e.target) &&\n         tableOfContents.classList.contains(\"toc-open\")) {\n            toggleTableOfContents();\n      }\n    });\n  \n    /* Toggle mobile toc */\n\n    tocButton.addEventListener('click', toggleTableOfContents, false);\n  \n  })();\n\n\n/*\n * update reading progress based on scroll position\n*/\n(function () {\n  const tocToggleButton = document.querySelector('#toc-toggle');\n  if (!tocToggleButton) {\n    return;\n  }\n\n  function updateProgress() {\n    const totalHeight = document.body.clientHeight;\n    const windowHeight = document.documentElement.clientHeight;\n    const position = window.scrollY;\n    const progress = position / (totalHeight - windowHeight)*100;\n    tocToggleButton.setAttribute('progress', `${progress.toFixed(0)}%`);\n\n    // this is used to update the circular progress bar show around the toc button\n    tocToggleButton.style.setProperty(\n    '--conic-gradient',\n    `var(--reading-progress-color) 0deg 0%,  \n      var(--reading-progress-color) 0deg ${ progress.toFixed(3) }%,\n      var(--background-color) 0deg ${ 1 - progress.toFixed(3) }%,\n      var(--background-color) 0deg 360deg`,\n    );\n    requestAnimationFrame(updateProgress);\n  }\n  requestAnimationFrame(updateProgress);\n})();\n","\n/* \nas of PhotoSwipe5 the script is imported as an ES module.   This means that this script must be imported into\nthe web page using\n<script type=\"module\" >\n</scipt>\n*/\nimport PhotoSwipeLightbox from './photoswipe-lightbox.esm.min.js';\n(function () {\n  const arrow =  ' <svg aria-hidden=\"true\" class=\"pswp__icn\" viewBox=\"0 0 32 30\" width=\"32\" height=\"30\">\\\n    <path d=\"M26.667 14.667v2.667h-16L18 24.667l-1.893 1.893L5.547 16l10.56-10.56L18 7.333l-7.333 7.333h16z\"> \\\n    </path> </svg>';\n\n  const options = {\n    arrowPrevSVG: arrow,\n    arrowNextSVG: arrow,\n    zoom: false,\n    gallery: '.kg-image-card, .kg-gallery-card',\n    children: 'img',\n    bgOpacity: 0.8,\n    closeOnScroll: true,\n    Xpadding: { top: 40, bottom: 40, left: 0, right: 0 },\n    imageClickAction: 'close',\n    tapAction: 'close',\n    pswpModule: () => import('./photoswipe.esm.min.js')\n  };\n\n  const lightbox = new PhotoSwipeLightbox(options);\n\n  lightbox.init();\n\n  /* \n  modify the item data used by photoswipe based on the attributes on the card image.\n  For images without height and width variables (e.g from posts converted from wordpress \n  the attributes are retrieved from the image\n  */\n  lightbox.addFilter('domItemData', (itemData, element, linkEl) => {\n\n    if (itemData) {\n      itemData.w = element.getAttribute(\"width\");\n      itemData.h = element.getAttribute(\"height\");\n      if ( ! itemData.h || ! itemData.w ) {\n        // get the original image size\n        itemData.w = element.naturalWidth;\n        itemData.h = element.naturalHeight;\n      }\n      itemData.src = element.getAttribute(\"src\");\n      itemData.srcset = element.getAttribute(\"srcset\");\n    }\n    return itemData;\n  });\n})();\n"]}