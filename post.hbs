{{!< default}}

{{#post}}
    {{!-- toc and social icons --}}
    {{#match @custom.post_layout_type "Sidebars / no feature image"}} 
        {{> "asides" layout="sidebar-layout"}}
    {{else match @custom.post_layout_type "Sidebars / feature image"}}
        {{> "asides" layout="sidebar-layout"}}
    {{else}}
        {{> "asides" layout="footer-layout"}}
    {{/match}}

    {{> "hero-header"}}

    {{!-- outputting post or page content --}}
    <article class="article-content">
        {{#if feature_image }}
            {{#match @custom.post_layout_type "Sidebars / feature image"}} 
                {{> "feature_image" }}
            {{else match @custom.post_layout_type "Footer / feature image"}}
                {{> "feature_image" }}
            {{else match @custom.post_layout_type "Footer / wide feature image"}}
                {{> "feature_image" image_format="wide" }}
            {{/match}}
        {{/if}}
        {{content}}
    </article>

    {{#if @custom.show_one_time_payment_request}}
        <aside class="one-time-payment-request">
            <div class="one-time-payment-icon" aria-label="one-time-donation">{{> "icons/donation"}}</div>
            <p class="one-time-payment-description">{{@custom.one_time_payment_description}}</p>
            <a href="#/portal/support" target="_blank" class="button one-time-payment-button">{{@custom.one_time_payment_button_text}}</a>
        </aside>
    {{/if}}
    {{#if @site.members_enabled}}
        {{#unless @member}}
            {{#match @custom.newsletter_banner_type "!=" "None"}}
                {{#match @custom.newsletter_banner_type "!=" "Large - posts only" }}
                {{#match @custom.newsletter_banner_type "!=" "Large - home page only" }}
                {{#match @custom.newsletter_banner_type "!=" "Large - home page & posts" }}
                {{#match @custom.newsletter_banner_type "!=" "Mini - home page only" }}
                    {{> "newsletter-banner" mini="true" }}
                {{/match}}
                {{/match}}
                {{/match}}
                {{/match}}

                {{#match @custom.newsletter_banner_type "!=" "Mini - posts only" }}
                {{#match @custom.newsletter_banner_type "!=" "Mini - home page only" }}
                {{#match @custom.newsletter_banner_type "!=" "Mini - home page & posts" }}
                {{#match @custom.newsletter_banner_type "!=" "Large - home page only" }}
                    {{> "newsletter-banner" }}
                {{/match}}
                {{/match}}
                {{/match}}
                {{/match}}
            {{/match}}
        {{/unless}}
    {{/if}}

    {{#if comments}}
        <aside class="comments">
            {{comments mode="auto"}}
        </aside>
    {{/if}}

    {{#if @custom.show_related_posts}}
        {{#get "posts" limit="6" include="tags" filter="id:-{{id}}+tag:[{{tags.[*].slug}}]" as |related|}}
        {{#if related}}
            <aside class="related-articles">
                <h3 class="related-articles-title">READ MORE</h3>
                {{#foreach related}}
                    {{> "article-card"}}
                {{/foreach}}
            </aside>
        {{/if}}
        {{/get}}
    {{/if}}
    
{{/post}}